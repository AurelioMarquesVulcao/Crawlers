const { PeticaoTJRS1 } = require('../extratores/PeticaoTJRS1');
const { OabTJRS } = require('../extratores/OabTJRS');
const Comarca = require('../models/schemas/comarcas');
require('../bootstrap');

const main = () => {
  // let extrator = new PeticaoTJRS1();

  let extrator = new OabTJRS(
    'https://www.tjrs.jus.br/site_php/consulta/index.php',
    false
  );
  extrator
    .extrair('71775RS', '5fb6a87a9f0dbd915a12b0bc', 1)
    .then((res) => console.log(res));

  // extrator.extrair('5018418-72.2019.8.21.0001').then(resp => console.log(resp));

  // let comarca = new Comarca({Estado: 'RS', Comarca: '000', Nome: 'teste', Tribunal: 21, Orgao: 8, Metadados: {slang: 'comarca_code', outro: 'outro'}});
  // comarca.salvar().then(e => console.log(e));

  // let feitos = Object.keys(comarcasCode).map(codigo => {
  //   let comarca_obj = {
  //     Estado: 'RS',
  //     Comarca: codigo,
  //     Nome: comarcasCode[codigo].nome,
  //     Tribunal: 8,
  //     Orgao: 21,
  //     Metadados: {
  //       tjrs_select_id: comarcasCode[codigo].id
  //     },
  //     UltimoProcesso: ultimosProcessos[Number(codigo)]
  //   }
  //
  //   if (ultimosProcessos[Number(codigo)])
  //     new Comarca(comarca_obj).salvar().then(e => console.log(`${codigo} -> ${ultimosProcessos[Number(codigo)]}`))
  // })
  //
  // console.log(feitos.filter(e => e).length)
};

const comarcasCode = {
  '001': { nome: 'Porto Alegre', id: 'porto_alegre' },
  154: { nome: 'Agudo', id: 'agudo' },
  '002': { nome: 'Alegrete', id: 'alegrete' },
  '003': { nome: 'Alvorada', id: 'alvorada' },
  '079': { nome: 'Antônio Prado', id: 'antonio_prado' },
  '080': { nome: 'Arroio do Meio', id: 'arroio_do_meio' },
  143: { nome: 'Arroio do Tigre', id: 'arroio_do_tigre' },
  '081': { nome: 'Arroio Grande', id: 'arroio_grande' },
  '082': { nome: 'Arvorezinha', id: 'arvorezinha' },
  149: { nome: 'Augusto Pestana', id: 'augusto_pestana' },
  '004': { nome: 'Bagé', id: 'bage' },
  140: { nome: 'Barra do Ribeiro', id: 'barra_do_ribeiro' },
  '005': { nome: 'Bento Gonçalves', id: 'bento_goncalves' },
  '083': { nome: 'Bom Jesus', id: 'bom_jesus' },
  '084': { nome: 'Butiá', id: 'butia' },
  '040': { nome: 'Caçapava do Sul', id: 'cacapava_do_sul' },
  '085': { nome: 'Cacequi', id: 'cacequi' },
  '006': { nome: 'Cachoeira do Sul', id: 'cachoeira_do_sul' },
  '086': { nome: 'Cachoeirinha', id: 'cachoeirinha' },
  '007': { nome: 'Camaquã', id: 'camaqua' },
  150: { nome: 'Campina das Missões', id: 'campina_das_missoes' },
  '087': { nome: 'Campo Bom', id: 'campo_bom' },
  '088': { nome: 'Campo Novo', id: 'campo_novo' },
  '089': { nome: 'Candelária', id: 'candelaria' },
  '041': { nome: 'Canela', id: 'canela' },
  '042': { nome: 'Canguçu', id: 'cangucu' },
  '008': { nome: 'Canoas', id: 'canoas' },
  141: { nome: 'Capão da Canoa', id: 'capao_da_canoa' },
  '009': { nome: 'Carazinho', id: 'carazinho' },
  144: { nome: 'Carlos Barbosa', id: 'carlos_barbosa' },
  '090': { nome: 'Casca', id: 'casca' },
  '091': { nome: 'Catuípe', id: 'catuipe' },
  '010': { nome: 'Caxias do Sul', id: 'caxias_do_sul' },
  '043': { nome: 'Cerro Largo', id: 'cerro_largo' },
  156: { nome: 'Charqueadas', id: 'charqueadas' },
  '092': { nome: 'Constantina', id: 'constantina' },
  '093': { nome: 'Coronel Bicaco', id: 'coronel_bicaco' },
  '094': { nome: 'Crissiumal', id: 'crissiumal' },
  '011': { nome: 'Cruz Alta', id: 'cruz_alta' },
  145: { nome: 'Dois Irmãos', id: 'dois_irmaos' },
  '012': { nome: 'Dom Pedrito', id: 'dom_pedrito' },
  165: { nome: 'Eldorado do Sul', id: 'eldorado_do_sul' },
  '044': { nome: 'Encantado', id: 'encantado' },
  '045': { nome: 'Encruzilhada do Sul', id: 'encruzilhada_do_sul' },
  '013': { nome: 'Erechim', id: 'erechim' },
  '046': { nome: 'Espumoso', id: 'espumoso' },
  '095': { nome: 'Estância Velha', id: 'estancia_velha' },
  '014': { nome: 'Esteio', id: 'esteio' },
  '047': { nome: 'Estrela', id: 'estrela' },
  '048': { nome: 'Farroupilha', id: 'farroupilha' },
  '096': { nome: 'Faxinal do Soturno', id: 'faxinal_do_soturno' },
  146: { nome: 'Feliz', id: 'feliz' },
  '097': { nome: 'Flores da Cunha', id: 'flores_da_cunha' },
  '049': { nome: 'Frederico Westphalen', id: 'frederico_westphalen' },
  '051': { nome: 'Garibaldi', id: 'garibaldi' },
  '098': { nome: 'Gaurama', id: 'gaurama' },
  '099': { nome: 'General Câmara', id: 'general_camara' },
  '050': { nome: 'Getúlio Vargas', id: 'getulio_vargas' },
  100: { nome: 'Giruá', id: 'girua' },
  101: { nome: 'Gramado', id: 'gramado' },
  '015': { nome: 'Gravataí', id: 'gravatai' },
  '052': { nome: 'Guaíba', id: 'guaiba' },
  '053': { nome: 'Guaporé', id: 'guapore' },
  102: { nome: 'Guarani das Missões', id: 'guarani_das_missoes' },
  103: { nome: 'Herval', id: 'herval' },
  104: { nome: 'Horizontina', id: 'horizontina' },
  105: { nome: 'Ibirubá', id: 'ibiruba' },
  142: { nome: 'Igrejinha', id: 'igrejinha' },
  '016': { nome: 'Ijuí', id: 'ijui' },
  106: { nome: 'Iraí', id: 'irai' },
  '054': { nome: 'Itaqui', id: 'itaqui' },
  166: { nome: 'Ivoti', id: 'ivoti' },
  '055': { nome: 'Jaguarão', id: 'jaguarao' },
  107: { nome: 'Jaguari', id: 'jaguari' },
  '056': { nome: 'Júlio de Castilhos', id: 'julio_de_castilhos' },
  '057': { nome: 'Lagoa Vermelha', id: 'lagoa_vermelha' },
  '017': { nome: 'Lajeado', id: 'lajeado' },
  108: { nome: 'Lavras do Sul', id: 'lavras_do_sul' },
  109: { nome: 'Marau', id: 'marau' },
  110: { nome: 'Marcelino Ramos', id: 'marcelino_ramos' },
  '018': { nome: 'Montenegro', id: 'montenegro' },
  111: { nome: 'Mostardas', id: 'mostardas' },
  112: { nome: 'Não-Me-Toque', id: 'nao_me_toque' },
  113: { nome: 'Nonoai', id: 'nonoai' },
  114: { nome: 'Nova Petrópolis', id: 'nova_petropolis' },
  '058': { nome: 'Nova Prata', id: 'nova_prata' },
  '019': { nome: 'Novo Hamburgo', id: 'novo_hamburgo' },
  '059': { nome: 'Osório', id: 'osorio' },
  151: { nome: 'Palmares do Sul', id: 'palmares_do_sul' },
  '020': { nome: 'Palmeira das Missões', id: 'palmeira_das_missoes' },
  '060': { nome: 'Panambi', id: 'panambi' },
  157: { nome: 'Parobé', id: 'parobe' },
  '021': { nome: 'Passo Fundo', id: 'passo_fundo' },
  115: { nome: 'Pedro Osório', id: 'pedro_osorio' },
  '022': { nome: 'Pelotas', id: 'pelotas' },
  117: { nome: 'Pinheiro Machado', id: 'pinheiro_machado' },
  118: { nome: 'Piratini', id: 'piratini' },
  116: { nome: 'Planalto', id: 'planalto' },
  155: { nome: 'Portão', id: 'portao' },
  119: { nome: 'Porto Xavier', id: 'porto_xavier' },
  '061': { nome: 'Quaraí', id: 'quarai' },
  147: { nome: 'Restinga Seca', id: 'restinga_seca' },
  '023': { nome: 'Rio Grande', id: 'rio_grande' },
  '024': { nome: 'Rio Pardo', id: 'rio_pardo' },
  158: { nome: 'Rodeio Bonito', id: 'rodeio_bonito' },
  148: { nome: 'Ronda Alta', id: 'ronda_alta' },
  '062': { nome: 'Rosário do Sul', id: 'rosario_do_sul' },
  161: { nome: 'Salto do Jacuí', id: 'salto_do_jacui' },
  120: { nome: 'Sananduva', id: 'sananduva' },
  121: { nome: 'Santa Bárbara do Sul', id: 'santa_barbara_do_sul' },
  '026': { nome: 'Santa Cruz do Sul', id: 'santa_cruz_do_sul' },
  '027': { nome: 'Santa Maria', id: 'santa_maria' },
  '028': { nome: 'Santa Rosa', id: 'santa_rosa' },
  '063': { nome: 'Santa Vitória do Palmar', id: 'santa_vitoria_do_palmar' },
  '025': { nome: 'Santana do Livramento', id: 'santana_do_livramento' },
  '064': { nome: 'Santiago', id: 'santiago' },
  '029': { nome: 'Santo Ângelo', id: 'santo_angelo' },
  '065': { nome: 'Santo Antônio da Patrulha', id: 'santo_antonio_da_patrulha' },
  122: { nome: 'Santo Antônio das Missões', id: 'santo_antonio_das_missoes' },
  123: { nome: 'Santo Augusto', id: 'santo_augusto' },
  124: { nome: 'Santo Cristo', id: 'santo_cristo' },
  '030': { nome: 'São Borja', id: 'sao_borja' },
  125: { nome: 'São Francisco de Assis', id: 'sao_francisco_de_assis' },
  '066': { nome: 'São Francisco de Paula', id: 'sao_francisco_de_paula' },
  '031': { nome: 'São Gabriel', id: 'sao_gabriel' },
  '032': { nome: 'São Jerônimo', id: 'sao_jeronimo' },
  126: { nome: 'São José do Norte', id: 'sao_jose_do_norte' },
  127: { nome: 'São José do Ouro', id: 'sao_jose_do_ouro' },
  '033': { nome: 'São Leopoldo', id: 'sao_leopoldo' },
  '067': { nome: 'São Lourenço do Sul', id: 'sao_lourenco_do_sul' },
  '034': { nome: 'São Luiz Gonzaga', id: 'sao_luiz_gonzaga' },
  128: { nome: 'São Marcos', id: 'sao_marcos' },
  129: { nome: 'São Pedro do Sul', id: 'sao_pedro_do_sul' },
  '068': { nome: 'São Sebastião do Caí', id: 'sao_sebastiao_do_cai' },
  130: { nome: 'São Sepé', id: 'sao_sepe' },
  152: { nome: 'São Valentim', id: 'sao_valentim' },
  131: { nome: 'São Vicente do Sul', id: 'sao_vicente_do_sul' },
  132: { nome: 'Sapiranga', id: 'sapiranga' },
  '035': { nome: 'Sapucaia do Sul', id: 'sapucaia_do_sul' },
  '069': { nome: 'Sarandi', id: 'sarandi' },
  133: { nome: 'Seberi', id: 'seberi' },
  134: { nome: 'Sobradinho', id: 'sobradinho' },
  '036': { nome: 'Soledade', id: 'soledade' },
  135: { nome: 'Tapejara', id: 'tapejara' },
  136: { nome: 'Tapera', id: 'tapera' },
  137: { nome: 'Tapes', id: 'tapes' },
  '070': { nome: 'Taquara', id: 'taquara' },
  '071': { nome: 'Taquari', id: 'taquari' },
  138: { nome: 'Tenente Portela', id: 'tenente_portela' },
  163: { nome: 'Terra de Areia', id: 'terra_de_areia' },
  159: { nome: 'Teutônia', id: 'teutonia' },
  '072': { nome: 'Torres', id: 'torres' },
  '073': { nome: 'Tramandaí', id: 'tramandai' },
  164: { nome: 'Três Coroas', id: 'tres_coroas' },
  '074': { nome: 'Três de Maio', id: 'tres_de_maio' },
  '075': { nome: 'Três Passos', id: 'tres_passos' },
  139: { nome: 'Triunfo', id: 'triunfo' },
  153: { nome: 'Tucunduva', id: 'tucunduva' },
  '076': { nome: 'Tupanciretã', id: 'tupancireta' },
  '037': { nome: 'Uruguaiana', id: 'uruguaiana' },
  '038': { nome: 'Vacaria', id: 'vacaria' },
  '077': { nome: 'Venâncio Aires', id: 'venancio_aires' },
};

const ultimosProcessos = {
  '67': '9000734-28.2020.8.21.0067',
  '32': '9000553-35.2020.8.21.0032',
  '68': '9000673-67.2020.8.21.0068',
  '90': '9000776-08.2020.8.21.0090',
  '82': '9000486-17.2020.8.21.0082',
  '138': '9001179-27.2020.8.21.0138',
  '77': '9001840-92.2020.8.21.0077',
  '38': '9001248-68.2020.8.21.0038',
  '37': '9001990-96.2020.8.21.0037',
  '76': '9000300-12.2020.8.21.0076',
  '74': '9000798-17.2020.8.21.0074',
  '73': '9001461-66.2020.8.21.0073',
  '72': '9001026-95.2020.8.21.0072',
  '70': '9001291-06.2020.8.21.0070',
  '36': '9001748-43.2020.8.21.0036',
  '69': '9000679-71.2020.8.21.0069',
  '35': '9001389-96.2020.8.21.0035',
  '34': '9000624-31.2020.8.21.0034',
  '33': '9004355-38.2020.8.21.0033',
  '31': '9000605-34.2020.8.21.0031',
  '29': '9001410-90.2020.8.21.0029',
  '30': '9001055-77.2020.8.21.0030',
  '66': '9000487-50.2020.8.21.0066',
  '65': '9000886-82.2020.8.21.0065',
  '63': '9000294-44.2020.8.21.0063',
  '64': '9000841-81.2020.8.21.0064',
  '25': '9001156-32.2020.8.21.0025',
  '28': '9001538-16.2020.8.21.0028',
  '26': '9002596-60.2020.8.21.0026',
  '62': '9000469-41.2020.8.21.0062',
  '27': '9004019-52.2020.8.21.0027',
  '24': '9000448-82.2020.8.21.0024',
  '60': '9000597-67.2020.8.21.0060',
  '21': '9004725-53.2020.8.21.0021',
  '23': '9002989-91.2020.8.21.0023',
  '22': '9004713-36.2020.8.21.0022',
  '59': '9001007-31.2020.8.21.0059',
  '20': '9001304-58.2020.8.21.0020',
  '58': '9001031-62.2020.8.21.0058',
  '57': '9000815-07.2020.8.21.0057',
  '163': '9000292-65.2020.8.21.0163',
  '55': '9000323-21.2020.8.21.0055',
  '148': '9000581-43.2020.8.21.0148',
  '17': '9002240-92.2020.8.21.0017',
  '150': '9000218-50.2020.8.21.0150',
  '145': '9000491-44.2020.8.21.0145',
  '88': '9000209-80.2020.8.21.0088',
  '136': '9000422-39.2020.8.21.0136',
  '140': '9000390-22.2020.8.21.0140',
  '134': '9000580-03.2020.8.21.0134',
  '133': '9000353-16.2020.8.21.0133',
  '87': '9000785-76.2020.8.21.0087',
  '10': '9005842-15.2020.8.21.0010',
  '132': '9001938-09.2020.8.21.0132',
  '130': '9000386-15.2020.8.21.0130',
  '129': '9000215-61.2020.8.21.0129',
  '80': '9000741-78.2020.8.21.0080',
  '128': '9000632-17.2020.8.21.0128',
  '48': '9001154-90.2020.8.21.0048',
  '135': '9000370-46.2020.8.21.0135',
  '108': '9000151-17.2020.8.21.0108',
  '47': '9000978-17.2020.8.21.0047',
  '131': '9000201-71.2020.8.21.0131',
  '81': '9000117-26.2020.8.21.0081',
  '106': '9000182-43.2020.8.21.0106',
  '104': '9000380-86.2020.8.21.0104',
  '101': '9001386-40.2020.8.21.0101',
  '137': '9000329-73.2020.8.21.0137',
  '84': '9000219-39.2020.8.21.0084',
  '109': '9000991-24.2020.8.21.0109',
  '144': '9000625-74.2020.8.21.0144',
  '2': '9000908-38.2020.8.21.0002',
  '156': '9000329-16.2020.8.21.0156',
  '1': '9026333-70.2020.8.21.0001',
  '153': '9000262-60.2020.8.21.0153',
  '92': '9000391-54.2020.8.21.0092',
  '117': '9000128-44.2020.8.21.0117',
  '42': '9000597-24.2020.8.21.0042',
  '100': '9000197-30.2020.8.21.0100',
  '16': '9002113-60.2020.8.21.0016',
  '142': '9000508-89.2020.8.21.0142',
  '147': '9000170-03.2020.8.21.0147',
  '51': '9000751-15.2020.8.21.0051',
  '7000': '0068567-78.2020.8.21.7000',
  '141': '9001855-63.2020.8.21.0141',
  '86': '9001524-52.2020.8.21.0086',
  '13': '9002752-87.2020.8.21.0013',
  '111': '9000222-10.2020.8.21.0111',
  '102': '9000176-48.2020.8.21.0102',
  '125': '9000477-23.2020.8.21.0125',
  '46': '9000545-16.2020.8.21.0046',
  '49': '9001851-11.2020.8.21.0049',
  '139': '9000503-76.2020.8.21.0139',
  '110': '9000156-33.2020.8.21.0110',
  '6': '9001114-40.2020.8.21.0006',
  '149': '9000191-70.2020.8.21.0149',
  '115': '9000108-59.2020.8.21.0115',
  '5': '9002193-57.2020.8.21.0005',
  '41': '9001911-08.2020.8.21.0041',
  '91': '9000166-37.2020.8.21.0091',
  '116': '9000362-29.2020.8.21.0116',
  '53': '9000736-40.2020.8.21.0053',
  '155': '9000399-36.2020.8.21.0155',
  '93': '9000581-14.2020.8.21.0093',
  '118': '9000147-47.2020.8.21.0118',
  '43': '9000343-48.2020.8.21.0043',
  '120': '9000540-63.2020.8.21.0120',
  '121': '9000242-68.2020.8.21.0121',
  '44': '9001349-87.2020.8.21.0044',
  '122': '9000108-38.2020.8.21.0122',
  '127': '9000546-49.2020.8.21.0127',
  '15': '9003239-51.2020.8.21.0015',
  '126': '9000437-38.2020.8.21.0126',
  '154': '9000241-81.2020.8.21.0154',
  '157': '9001062-76.2020.8.21.0157',
  '94': '9000301-40.2020.8.21.0094',
  '161': '9000201-78.2020.8.21.0161',
  '96': '9000216-48.2020.8.21.0096',
  '54': '9000387-34.2020.8.21.0054',
  '159': '9000969-10.2020.8.21.0159',
  '11': '9001319-54.2020.8.21.0011',
  '95': '9000703-21.2020.8.21.0095',
  '18': '9001229-25.2020.8.21.0018',
  '158': '9000356-90.2020.8.21.0158',
  '165': '9000362-76.2020.8.21.0165',
  '12': '9000223-98.2020.8.21.0012',
  '98': '9000469-30.2020.8.21.0098',
  '19': '9003453-30.2020.8.21.0019',
  '166': '9000302-03.2020.8.21.0166',
  '7': '9001711-06.2020.8.21.0007',
  '4': '9001691-24.2020.8.21.0004',
  '99': '9000237-15.2020.8.21.0099',
  '40': '9000519-36.2020.8.21.0040',
  '89': '9000692-10.2020.8.21.0089',
  '71': '9000588-72.2020.8.21.0071',
  '8': '9004522-33.2020.8.21.0008',
  '9': '9001794-16.2020.8.21.0009',
  '45': '9000563-40.2020.8.21.0045',
  '119': '9000202-92.2020.8.21.0119',
  '14': '9001409-53.2020.8.21.0014',
  '97': '9000611-37.2020.8.21.0097',
  '151': '9000354-44.2020.8.21.0151',
  '52': '9000987-61.2020.8.21.0052',
  '143': '9000503-64.2020.8.21.0143',
  '50': '9000773-76.2020.8.21.0050',
};

main();

// db.processo.aggregate([
//   {'$match': {
//       'CnjDetalhes.Tribunal': 21,
//       'CnjDetalhes.OrgaoJustica': 8,
//       'CnjDetalhes.Ano': 2020,
//     }},
//   {'$group': {
//       '_id': '$CnjDetalhes.UnidadeOrigem',
//       'NumeroCNJ': {'$max': '$NumeroCNJ'},
//     }},
//   {'$project': {
//       '_id': 0,
//       'Comarca': '$_id',
//       'NumeroCNJ': 1,
//     }},
// ])
